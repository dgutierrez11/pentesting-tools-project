__all__ = [
    'main',
]

from DAST_API_Tools.zaproxy_scan import scan_application
from configparser import ConfigParser


def main(filename='../resources/configuration.ini', section='APP'):
    # create a parser
    parser = ConfigParser()
    # read config file
    parser.read(filename)

    # get section, default to APP
    app = {}
    if parser.has_section(section):
        target = parser.get(section, 'target', fallback='Target is not defined')
        apikey = parser.get(section, 'zapkey', fallback='Target is not defined')
        print("Executing")
        scan_application(target, apikey)
    else:
        raise Exception('Section {0} not found in the {1} file'.format(section, filename))


if __name__ == '__main__':
    main()
